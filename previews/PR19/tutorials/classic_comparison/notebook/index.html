<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Milk Quality Classification · MLJTransforms</title><meta name="title" content="Milk Quality Classification · MLJTransforms"/><meta property="og:title" content="Milk Quality Classification · MLJTransforms"/><meta property="twitter:title" content="Milk Quality Classification · MLJTransforms"/><meta name="description" content="Documentation for MLJTransforms."/><meta property="og:description" content="Documentation for MLJTransforms."/><meta property="twitter:description" content="Documentation for MLJTransforms."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&amp;display=swap" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.gif" alt="MLJTransforms logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">MLJTransforms</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Transformers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../transformers/all_transformers/">All Transformers</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Encoders</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../transformers/classical/">Classical Encoders</a></li><li><a class="tocitem" href="../../../transformers/neural/">Neural-based Encoders</a></li><li><a class="tocitem" href="../../../transformers/contrast/">Contrast Encoders</a></li><li><a class="tocitem" href="../../../transformers/utility/">Utility Encoders</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Extended Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../standardization/notebook/">Standardization Impact</a></li><li class="is-active"><a class="tocitem" href>Milk Quality Classification</a><ul class="internal"><li><a class="tocitem" href="#Load-and-Prepare-Data"><span>Load and Prepare Data</span></a></li><li><a class="tocitem" href="#Split-Data"><span>Split Data</span></a></li><li><a class="tocitem" href="#Setup-Encoders-and-Classifier"><span>Setup Encoders and Classifier</span></a></li><li><a class="tocitem" href="#Evaluate-Pipelines"><span>Evaluate Pipelines</span></a></li><li><a class="tocitem" href="#Results-Analysis"><span>Results Analysis</span></a></li></ul></li><li><a class="tocitem" href="../../wine_example/notebook/">Wine Quality Prediction</a></li><li><a class="tocitem" href="../../entity_embeddings/notebook/">Entity Embeddings Tutorial</a></li></ul></li><li><a class="tocitem" href="../../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../../about/">About</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Extended Examples</a></li><li class="is-active"><a href>Milk Quality Classification</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Milk Quality Classification</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaAI/MLJTransforms.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaAI/MLJTransforms.jl/blob/dev/docs/src/tutorials/classic_comparison/notebook.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Categorical-Encoders-Performance:-A-Classic-Comparison"><a class="docs-heading-anchor" href="#Categorical-Encoders-Performance:-A-Classic-Comparison">Categorical Encoders Performance: A Classic Comparison</a><a id="Categorical-Encoders-Performance:-A-Classic-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Categorical-Encoders-Performance:-A-Classic-Comparison" title="Permalink"></a></h1><p><strong>Julia version</strong> is assumed to be 1.10.*</p><p>This demonstration is available as a Jupyter notebook or julia script (as well as the dataset) <a href="https://github.com/essamwise/MLJTransforms.jl/tree/main/docs/src/tutorials/classic_comparison">here</a>.</p><p>This tutorial compares four fundamental categorical encoding approaches on a milk quality dataset: OneHot, Frequency, Target, and Ordinal encoders paired with SVM classification.</p><pre><code class="language-julia hljs">using Pkg;
Pkg.activate(@__DIR__);

using MLJ, MLJTransforms, LIBSVM, DataFrames, ScientificTypes
using Random, CSV</code></pre><pre><code class="nohighlight hljs">  Activating project at `~/Documents/GitHub/MLJTransforms/docs/src/tutorials/classic_comparison`
</code></pre><h2 id="Load-and-Prepare-Data"><a class="docs-heading-anchor" href="#Load-and-Prepare-Data">Load and Prepare Data</a><a id="Load-and-Prepare-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Load-and-Prepare-Data" title="Permalink"></a></h2><p>Load the milk quality dataset which contains categorical features for quality prediction:</p><pre><code class="language-julia hljs">df = CSV.read(&quot;./milknew.csv&quot;, DataFrame)

first(df, 5)</code></pre><div><div style = "float: left;"><span>5×8 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">pH</th><th style = "text-align: left;">Temprature</th><th style = "text-align: left;">Taste</th><th style = "text-align: left;">Odor</th><th style = "text-align: left;">Fat </th><th style = "text-align: left;">Turbidity</th><th style = "text-align: left;">Colour</th><th style = "text-align: left;">Grade</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">6.6</td><td style = "text-align: right;">35</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">254</td><td style = "text-align: left;">high</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">6.6</td><td style = "text-align: right;">36</td><td style = "text-align: right;">0</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">1</td><td style = "text-align: right;">253</td><td style = "text-align: left;">high</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">8.5</td><td style = "text-align: right;">70</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">246</td><td style = "text-align: left;">low</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">9.5</td><td style = "text-align: right;">34</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">1</td><td style = "text-align: right;">255</td><td style = "text-align: left;">low</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">6.6</td><td style = "text-align: right;">37</td><td style = "text-align: right;">0</td><td style = "text-align: right;">0</td><td style = "text-align: right;">0</td><td style = "text-align: right;">0</td><td style = "text-align: right;">255</td><td style = "text-align: left;">medium</td></tr></tbody></table></div><p>Check the scientific types to understand our data structure:</p><pre><code class="language-julia hljs">ScientificTypes.schema(df)</code></pre><pre><code class="nohighlight hljs">┌────────────┬────────────┬─────────┐
│ names      │ scitypes   │ types   │
├────────────┼────────────┼─────────┤
│ pH         │ Continuous │ Float64 │
│ Temprature │ Count      │ Int64   │
│ Taste      │ Count      │ Int64   │
│ Odor       │ Count      │ Int64   │
│ Fat        │ Count      │ Int64   │
│ Turbidity  │ Count      │ Int64   │
│ Colour     │ Count      │ Int64   │
│ Grade      │ Textual    │ String7 │
└────────────┴────────────┴─────────┘
</code></pre><p>Automatically coerce columns with few unique values to categorical:</p><pre><code class="language-julia hljs">df = coerce(df, autotype(df, :few_to_finite))

ScientificTypes.schema(df)</code></pre><pre><code class="nohighlight hljs">┌────────────┬───────────────────┬───────────────────────────────────┐
│ names      │ scitypes          │ types                             │
├────────────┼───────────────────┼───────────────────────────────────┤
│ pH         │ OrderedFactor{16} │ CategoricalValue{Float64, UInt32} │
│ Temprature │ OrderedFactor{17} │ CategoricalValue{Int64, UInt32}   │
│ Taste      │ OrderedFactor{2}  │ CategoricalValue{Int64, UInt32}   │
│ Odor       │ OrderedFactor{2}  │ CategoricalValue{Int64, UInt32}   │
│ Fat        │ OrderedFactor{2}  │ CategoricalValue{Int64, UInt32}   │
│ Turbidity  │ OrderedFactor{2}  │ CategoricalValue{Int64, UInt32}   │
│ Colour     │ OrderedFactor{9}  │ CategoricalValue{Int64, UInt32}   │
│ Grade      │ Multiclass{3}     │ CategoricalValue{String7, UInt32} │
└────────────┴───────────────────┴───────────────────────────────────┘
</code></pre><h2 id="Split-Data"><a class="docs-heading-anchor" href="#Split-Data">Split Data</a><a id="Split-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Split-Data" title="Permalink"></a></h2><p>Separate features from target and create train/test split:</p><pre><code class="language-julia hljs">y, X = unpack(df, ==(:Grade); rng = 123)
train, test = partition(eachindex(y), 0.9, shuffle = true, rng = 100);</code></pre><h2 id="Setup-Encoders-and-Classifier"><a class="docs-heading-anchor" href="#Setup-Encoders-and-Classifier">Setup Encoders and Classifier</a><a id="Setup-Encoders-and-Classifier-1"></a><a class="docs-heading-anchor-permalink" href="#Setup-Encoders-and-Classifier" title="Permalink"></a></h2><p>Load the required models and create different encoding strategies:</p><pre><code class="language-julia hljs">OneHot = @load OneHotEncoder pkg = MLJModels verbosity = 0
SVC = @load SVC pkg = LIBSVM verbosity = 0</code></pre><pre><code class="nohighlight hljs">MLJLIBSVMInterface.SVC</code></pre><p><strong>Encoding Strategies Explained:</strong></p><ol><li><strong>OneHot</strong>: Creates binary columns for each category (sparse, interpretable)</li><li><strong>Frequency</strong>: Replaces categories with their occurrence frequency</li><li><strong>Target</strong>: Uses target statistics for each category</li><li><strong>Ordinal</strong>: Assigns integer codes to categories (assumes ordering)</li></ol><pre><code class="language-julia hljs">onehot_model = OneHot(drop_last = true, ordered_factor = true)
freq_model = MLJTransforms.FrequencyEncoder(normalize = false, ordered_factor = true)
target_model = MLJTransforms.TargetEncoder(lambda = 0.9, m = 5, ordered_factor = true)
ordinal_model = MLJTransforms.OrdinalEncoder(ordered_factor = true)
svm = SVC()</code></pre><pre><code class="nohighlight hljs">SVC(
  kernel = LIBSVM.Kernel.RadialBasis, 
  gamma = 0.0, 
  cost = 1.0, 
  cachesize = 200.0, 
  degree = 3, 
  coef0 = 0.0, 
  tolerance = 0.001, 
  shrinking = true)</code></pre><p>Create four different pipelines to compare:</p><pre><code class="language-julia hljs">pipelines = [
    (&quot;OneHot + SVM&quot;, onehot_model |&gt; svm),
    (&quot;FreqEnc + SVM&quot;, freq_model |&gt; svm),
    (&quot;TargetEnc + SVM&quot;, target_model |&gt; svm),
    (&quot;Ordinal + SVM&quot;, ordinal_model |&gt; svm),
]</code></pre><pre><code class="nohighlight hljs">4-element Vector{Tuple{String, MLJBase.DeterministicPipeline{N, MLJModelInterface.predict} where N&lt;:NamedTuple}}:
 (&quot;OneHot + SVM&quot;, DeterministicPipeline(one_hot_encoder = OneHotEncoder(features = Symbol[], …), …))
 (&quot;FreqEnc + SVM&quot;, DeterministicPipeline(frequency_encoder = FrequencyEncoder(features = Symbol[], …), …))
 (&quot;TargetEnc + SVM&quot;, DeterministicPipeline(target_encoder = TargetEncoder(features = Symbol[], …), …))
 (&quot;Ordinal + SVM&quot;, DeterministicPipeline(ordinal_encoder = OrdinalEncoder(features = Symbol[], …), …))</code></pre><h2 id="Evaluate-Pipelines"><a class="docs-heading-anchor" href="#Evaluate-Pipelines">Evaluate Pipelines</a><a id="Evaluate-Pipelines-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluate-Pipelines" title="Permalink"></a></h2><p>Use 10-fold cross-validation to robustly estimate each pipeline&#39;s accuracy:</p><pre><code class="language-julia hljs">results = DataFrame(pipeline = String[], accuracy = Float64[])

for (name, pipe) in pipelines
    println(&quot;Evaluating: $name&quot;)
    mach = machine(pipe, X, y)
    eval_results = evaluate!(
        mach,
        resampling = CV(nfolds = 10, rng = 123),
        measure = accuracy,
        rows = train,
        verbosity = 0,
    )
    acc = mean(eval_results.measurement)
    push!(results, (name, acc))
end</code></pre><pre><code class="nohighlight hljs">Evaluating: OneHot + SVM
Evaluating: FreqEnc + SVM
Evaluating: TargetEnc + SVM
Evaluating: Ordinal + SVM
</code></pre><p>Sort results by accuracy (highest first) and display:</p><pre><code class="language-julia hljs">sort!(results, :accuracy, rev = true)
results</code></pre><div><div style = "float: left;"><span>4×2 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">pipeline</th><th style = "text-align: left;">accuracy</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">OneHot + SVM</td><td style = "text-align: right;">0.998951</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">TargetEnc + SVM</td><td style = "text-align: right;">0.974816</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">Ordinal + SVM</td><td style = "text-align: right;">0.940189</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">FreqEnc + SVM</td><td style = "text-align: right;">0.885624</td></tr></tbody></table></div><h2 id="Results-Analysis"><a class="docs-heading-anchor" href="#Results-Analysis">Results Analysis</a><a id="Results-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Results-Analysis" title="Permalink"></a></h2><p>We notice that one-hot-encoding was the most performant here followed by target encoding. Ordinal encoding also produced decent results because we can perceive all the categorical variables to be ordered On the other hand, frequency encoding lagged behind. Observe that this method doesn&#39;t distinguish categories from one another if they occur with similar frequencies.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../standardization/notebook/">« Standardization Impact</a><a class="docs-footer-nextpage" href="../../wine_example/notebook/">Wine Quality Prediction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 24 August 2025 03:35">Sunday 24 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
